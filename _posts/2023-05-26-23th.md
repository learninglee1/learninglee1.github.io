---
layout: single
title:  "PyTorch - ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ë¥¼ í™œìš©í•œ ì´ë¯¸ì§€ ë¶„ë¥˜(23) "
---

# 12ì¥ ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ë¥¼ í™œìš©í•œ ì´ë¯¸ì§€ ë¶„ë¥˜

* í•œê¸€ í°íŠ¸ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì¶œë ¥í•˜ê¸° ìœ„í•œ ì„¤ì¹˜ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.


```python
!sudo apt-get install -y fonts-nanum* | tail -n 1
!sudo fc-cache -fv
!rm -rf ~/.cache/matplotlib
```

    debconf: unable to initialize frontend: Dialog
    debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 76, <> line 4.)
    debconf: falling back to frontend: Readline
    debconf: unable to initialize frontend: Readline
    debconf: (This frontend requires a controlling tty.)
    debconf: falling back to frontend: Teletype
    dpkg-preconfigure: unable to re-open stdin: 
    Processing triggers for fontconfig (2.12.6-0ubuntu2) ...
    /usr/share/fonts: caching, new cache contents: 0 fonts, 1 dirs
    /usr/share/fonts/truetype: caching, new cache contents: 0 fonts, 3 dirs
    /usr/share/fonts/truetype/humor-sans: caching, new cache contents: 1 fonts, 0 dirs
    /usr/share/fonts/truetype/liberation: caching, new cache contents: 16 fonts, 0 dirs
    /usr/share/fonts/truetype/nanum: caching, new cache contents: 31 fonts, 0 dirs
    /usr/local/share/fonts: caching, new cache contents: 0 fonts, 0 dirs
    /root/.local/share/fonts: skipping, no such directory
    /root/.fonts: skipping, no such directory
    /var/cache/fontconfig: cleaning cache directory
    /root/.cache/fontconfig: not cleaning non-existent cache directory
    /root/.fontconfig: not cleaning non-existent cache directory
    fc-cache: succeeded
    


```python
# í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

!pip install torchviz | tail -n 1
!pip install torchinfo | tail -n 1
w = !apt install tree
print(w[-2])
```

    Successfully installed torchviz-0.0.2
    Successfully installed torchinfo-1.6.5
    Setting up tree (1.7.0-5) ...
    

* ëª¨ë“  ì„¤ì¹˜ê°€ ëë‚˜ë©´ í•œê¸€ í°íŠ¸ë¥¼ ë°”ë¥´ê²Œ ì¶œë ¥í•˜ê¸° ìœ„í•´ **[ëŸ°íƒ€ì„]** -> **[ëŸ°íƒ€ì„ ë‹¤ì‹œì‹œì‘]**ì„ í´ë¦­í•œ ë‹¤ìŒ, ì•„ë˜ ì…€ë¶€í„° ì½”ë“œë¥¼ ì‹¤í–‰í•´ ì£¼ì‹­ì‹œì˜¤.


```python
# ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸

%matplotlib inline
import numpy as np
import matplotlib.pyplot as plt
from IPython.display import display

# í°íŠ¸ ê´€ë ¨ ìš©ë„
import matplotlib.font_manager as fm

# ë‚˜ëˆ” ê³ ë”• í°íŠ¸ì˜ ê²½ë¡œ ëª…ì‹œ
path = '/usr/share/fonts/truetype/nanum/NanumGothic.ttf'
font_name = fm.FontProperties(fname=path, size=10).get_name()
```


```python
# íŒŒì´í† ì¹˜ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬

import torch
from torch import tensor
import torch.nn as nn
import torch.optim as optim
from torchinfo import summary
from torchviz import make_dot
import torchvision.transforms as transforms
from torch.utils.data import Dataset, DataLoader
import torchvision.datasets as datasets
```


```python
# warning í‘œì‹œ ë„ê¸°
import warnings
warnings.simplefilter('ignore')

# ê¸°ë³¸ í°íŠ¸ ì„¤ì •
plt.rcParams['font.family'] = font_name

# ê¸°ë³¸ í°íŠ¸ ì‚¬ì´ì¦ˆ ë³€ê²½
plt.rcParams['font.size'] = 14

# ê¸°ë³¸ ê·¸ë˜í”„ ì‚¬ì´ì¦ˆ ë³€ê²½
plt.rcParams['figure.figsize'] = (6,6)

# ê¸°ë³¸ ê·¸ë¦¬ë“œ í‘œì‹œ
# í•„ìš”ì— ë”°ë¼ ì„¤ì •í•  ë•ŒëŠ”, plt.grid()
plt.rcParams['axes.grid'] = True

# ë§ˆì´ë„ˆìŠ¤ ê¸°í˜¸ ì •ìƒ ì¶œë ¥
plt.rcParams['axes.unicode_minus'] = False

# ë„˜íŒŒì´ ë¶€ë™ì†Œìˆ˜ì  ìë¦¿ìˆ˜ í‘œì‹œ
np.set_printoptions(suppress=True, precision=4)
```


```python
# GPU ë””ë°”ì´ìŠ¤ í• ë‹¹

device = torch.device("cuda:0" if torch.cuda.is_available() else "cpu")
print(device)
```

    cuda:0
    

### ê³µí†µ í•¨ìˆ˜ ë¶ˆëŸ¬ì˜¤ê¸°


```python
# ê³µí†µ í•¨ìˆ˜ ë‹¤ìš´ë¡œë“œ
!git clone https://github.com/wikibook/pythonlibs.git

# ê³µí†µ í•¨ìˆ˜ ë¶ˆëŸ¬ì˜¤ê¸°
from pythonlibs.torch_lib1 import *

# ê³µí†µ í•¨ìˆ˜ í™•ì¸
print(README)
```

    Cloning into 'pythonlibs'...
    remote: Enumerating objects: 18, done.[K
    remote: Counting objects: 100% (18/18), done.[K
    remote: Compressing objects: 100% (13/13), done.[K
    remote: Total 18 (delta 2), reused 18 (delta 2), pack-reused 0[K
    Unpacking objects: 100% (18/18), done.
    Common Library for PyTorch
    Author: M. Akaishi
    

## 12.3 ë°ì´í„° ì¤€ë¹„

### ë°ì´í„° ë‹¤ìš´ë¡œë“œ, ì••ì¶• í•´ì œ, íŠ¸ë¦¬ êµ¬ì¡° ì¶œë ¥


```python
# ë°ì´í„° ë‹¤ìš´ë¡œë“œ
w = !wget -nc https://download.pytorch.org/tutorial/hymenoptera_data.zip

# ê²°ê³¼ í™•ì¸
print(w[-2])
```

    2022-04-10 14:24:10 (46.5 MB/s) - â€˜hymenoptera_data.zipâ€™ saved [47286322/47286322]
    


```python
# ì••ì¶• í•´ì œ
w = !unzip -o hymenoptera_data.zip

# ê²°ê³¼ í™•ì¸
print(w[-1])
```

      inflating: hymenoptera_data/val/bees/abeja.jpg  
    


```python
# íŠ¸ë¦¬ êµ¬ì¡° ì¶œë ¥
!tree hymenoptera_data
```

    hymenoptera_data
    â”œâ”€â”€ train
    â”‚Â Â  â”œâ”€â”€ ants
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 0013035.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1030023514_aad5c608f9.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1095476100_3906d8afde.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1099452230_d1949d3250.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 116570827_e9c126745d.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1225872729_6f0856588f.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1262877379_64fcada201.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1269756697_0bce92cdab.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1286984635_5119e80de1.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 132478121_2a430adea2.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1360291657_dc248c5eea.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1368913450_e146e2fb6d.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1473187633_63ccaacea6.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 148715752_302c84f5a4.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1489674356_09d48dde0a.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 149244013_c529578289.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 150801003_3390b73135.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 150801171_cd86f17ed8.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 154124431_65460430f2.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 162603798_40b51f1654.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1660097129_384bf54490.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 167890289_dd5ba923f3.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1693954099_46d4c20605.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 175998972.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 178538489_bec7649292.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1804095607_0341701e1c.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1808777855_2a895621d7.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 188552436_605cc9b36b.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1917341202_d00a7f9af5.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 1924473702_daa9aacdbe.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 196057951_63bf063b92.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 196757565_326437f5fe.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 201558278_fe4caecc76.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 201790779_527f4c0168.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2019439677_2db655d361.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 207947948_3ab29d7207.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 20935278_9190345f6b.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 224655713_3956f7d39a.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2265824718_2c96f485da.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2265825502_fff99cfd2d.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 226951206_d6bf946504.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2278278459_6b99605e50.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2288450226_a6e96e8fdf.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2288481644_83ff7e4572.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2292213964_ca51ce4bef.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 24335309_c5ea483bb8.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 245647475_9523dfd13e.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 255434217_1b2b3fe0a4.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 258217966_d9d90d18d3.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 275429470_b2d7d9290b.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 28847243_e79fe052cd.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 318052216_84dff3f98a.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 334167043_cbd1adaeb9.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 339670531_94b75ae47a.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 342438950_a3da61deab.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 36439863_0bec9f554f.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 374435068_7eee412ec4.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 382971067_0bfd33afe0.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 384191229_5779cf591b.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 386190770_672743c9a7.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 392382602_1b7bed32fa.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 403746349_71384f5b58.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 408393566_b5b694119b.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 424119020_6d57481dab.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 424873399_47658a91fb.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 450057712_771b3bfc91.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 45472593_bfd624f8dc.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 459694881_ac657d3187.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 460372577_f2f6a8c9fc.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 460874319_0a45ab4d05.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 466430434_4000737de9.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 470127037_513711fd21.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 474806473_ca6caab245.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 475961153_b8c13fd405.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 484293231_e53cfc0c89.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 49375974_e28ba6f17e.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 506249802_207cd979b4.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 506249836_717b73f540.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 512164029_c0a66b8498.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 512863248_43c8ce579b.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 518773929_734dbc5ff4.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 522163566_fec115ca66.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 522415432_2218f34bf8.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 531979952_bde12b3bc0.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 533848102_70a85ad6dd.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 535522953_308353a07c.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 540889389_48bb588b21.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 541630764_dbd285d63c.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 543417860_b14237f569.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 560966032_988f4d7bc4.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 5650366_e22b7e1065.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 6240329_72c01e663e.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 6240338_93729615ec.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 649026570_e58656104b.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 662541407_ff8db781e7.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 67270775_e9fdf77e9d.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 6743948_2b8c096dda.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 684133190_35b62c0c1d.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 69639610_95e0de17aa.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 707895295_009cf23188.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 7759525_1363d24e88.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 795000156_a9900a4a71.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 822537660_caf4ba5514.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 82852639_52b7f7f5e3.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 841049277_b28e58ad05.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 886401651_f878e888cd.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 892108839_f1aad4ca46.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 938946700_ca1c669085.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 957233405_25c1d1187b.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 9715481_b3cb4114ff.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 998118368_6ac1d91f81.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Ant_1.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ ant photos.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ army-ants-red-picture.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ formica.jpeg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ hormiga_co_por.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ imageNotFound.gif
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ kurokusa.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ MehdiabadiAnt2_600.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Nepenthes_rafflesiana_ant.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ swiss-army-ant.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ termite-vs-ant.jpg
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ trap-jaw-ant-insect-bg.jpg
    â”‚Â Â  â”‚Â Â  â””â”€â”€ VietnameseAntMimicSpider.jpg
    â”‚Â Â  â””â”€â”€ bees
    â”‚Â Â      â”œâ”€â”€ 1092977343_cb42b38d62.jpg
    â”‚Â Â      â”œâ”€â”€ 1093831624_fb5fbe2308.jpg
    â”‚Â Â      â”œâ”€â”€ 1097045929_1753d1c765.jpg
    â”‚Â Â      â”œâ”€â”€ 1232245714_f862fbe385.jpg
    â”‚Â Â      â”œâ”€â”€ 129236073_0985e91c7d.jpg
    â”‚Â Â      â”œâ”€â”€ 1295655112_7813f37d21.jpg
    â”‚Â Â      â”œâ”€â”€ 132511197_0b86ad0fff.jpg
    â”‚Â Â      â”œâ”€â”€ 132826773_dbbcb117b9.jpg
    â”‚Â Â      â”œâ”€â”€ 150013791_969d9a968b.jpg
    â”‚Â Â      â”œâ”€â”€ 1508176360_2972117c9d.jpg
    â”‚Â Â      â”œâ”€â”€ 154600396_53e1252e52.jpg
    â”‚Â Â      â”œâ”€â”€ 16838648_415acd9e3f.jpg
    â”‚Â Â      â”œâ”€â”€ 1691282715_0addfdf5e8.jpg
    â”‚Â Â      â”œâ”€â”€ 17209602_fe5a5a746f.jpg
    â”‚Â Â      â”œâ”€â”€ 174142798_e5ad6d76e0.jpg
    â”‚Â Â      â”œâ”€â”€ 1799726602_8580867f71.jpg
    â”‚Â Â      â”œâ”€â”€ 1807583459_4fe92b3133.jpg
    â”‚Â Â      â”œâ”€â”€ 196430254_46bd129ae7.jpg
    â”‚Â Â      â”œâ”€â”€ 196658222_3fffd79c67.jpg
    â”‚Â Â      â”œâ”€â”€ 198508668_97d818b6c4.jpg
    â”‚Â Â      â”œâ”€â”€ 2031225713_50ed499635.jpg
    â”‚Â Â      â”œâ”€â”€ 2037437624_2d7bce461f.jpg
    â”‚Â Â      â”œâ”€â”€ 2053200300_8911ef438a.jpg
    â”‚Â Â      â”œâ”€â”€ 205835650_e6f2614bee.jpg
    â”‚Â Â      â”œâ”€â”€ 208702903_42fb4d9748.jpg
    â”‚Â Â      â”œâ”€â”€ 21399619_3e61e5bb6f.jpg
    â”‚Â Â      â”œâ”€â”€ 2227611847_ec72d40403.jpg
    â”‚Â Â      â”œâ”€â”€ 2321139806_d73d899e66.jpg
    â”‚Â Â      â”œâ”€â”€ 2330918208_8074770c20.jpg
    â”‚Â Â      â”œâ”€â”€ 2345177635_caf07159b3.jpg
    â”‚Â Â      â”œâ”€â”€ 2358061370_9daabbd9ac.jpg
    â”‚Â Â      â”œâ”€â”€ 2364597044_3c3e3fc391.jpg
    â”‚Â Â      â”œâ”€â”€ 2384149906_2cd8b0b699.jpg
    â”‚Â Â      â”œâ”€â”€ 2397446847_04ef3cd3e1.jpg
    â”‚Â Â      â”œâ”€â”€ 2405441001_b06c36fa72.jpg
    â”‚Â Â      â”œâ”€â”€ 2445215254_51698ff797.jpg
    â”‚Â Â      â”œâ”€â”€ 2452236943_255bfd9e58.jpg
    â”‚Â Â      â”œâ”€â”€ 2467959963_a7831e9ff0.jpg
    â”‚Â Â      â”œâ”€â”€ 2470492904_837e97800d.jpg
    â”‚Â Â      â”œâ”€â”€ 2477324698_3d4b1b1cab.jpg
    â”‚Â Â      â”œâ”€â”€ 2477349551_e75c97cf4d.jpg
    â”‚Â Â      â”œâ”€â”€ 2486729079_62df0920be.jpg
    â”‚Â Â      â”œâ”€â”€ 2486746709_c43cec0e42.jpg
    â”‚Â Â      â”œâ”€â”€ 2493379287_4100e1dacc.jpg
    â”‚Â Â      â”œâ”€â”€ 2495722465_879acf9d85.jpg
    â”‚Â Â      â”œâ”€â”€ 2528444139_fa728b0f5b.jpg
    â”‚Â Â      â”œâ”€â”€ 2538361678_9da84b77e3.jpg
    â”‚Â Â      â”œâ”€â”€ 2551813042_8a070aeb2b.jpg
    â”‚Â Â      â”œâ”€â”€ 2580598377_a4caecdb54.jpg
    â”‚Â Â      â”œâ”€â”€ 2601176055_8464e6aa71.jpg
    â”‚Â Â      â”œâ”€â”€ 2610833167_79bf0bcae5.jpg
    â”‚Â Â      â”œâ”€â”€ 2610838525_fe8e3cae47.jpg
    â”‚Â Â      â”œâ”€â”€ 2617161745_fa3ebe85b4.jpg
    â”‚Â Â      â”œâ”€â”€ 2625499656_e3415e374d.jpg
    â”‚Â Â      â”œâ”€â”€ 2634617358_f32fd16bea.jpg
    â”‚Â Â      â”œâ”€â”€ 2638074627_6b3ae746a0.jpg
    â”‚Â Â      â”œâ”€â”€ 2645107662_b73a8595cc.jpg
    â”‚Â Â      â”œâ”€â”€ 2651621464_a2fa8722eb.jpg
    â”‚Â Â      â”œâ”€â”€ 2652877533_a564830cbf.jpg
    â”‚Â Â      â”œâ”€â”€ 266644509_d30bb16a1b.jpg
    â”‚Â Â      â”œâ”€â”€ 2683605182_9d2a0c66cf.jpg
    â”‚Â Â      â”œâ”€â”€ 2704348794_eb5d5178c2.jpg
    â”‚Â Â      â”œâ”€â”€ 2707440199_cd170bd512.jpg
    â”‚Â Â      â”œâ”€â”€ 2710368626_cb42882dc8.jpg
    â”‚Â Â      â”œâ”€â”€ 2722592222_258d473e17.jpg
    â”‚Â Â      â”œâ”€â”€ 2728759455_ce9bb8cd7a.jpg
    â”‚Â Â      â”œâ”€â”€ 2756397428_1d82a08807.jpg
    â”‚Â Â      â”œâ”€â”€ 2765347790_da6cf6cb40.jpg
    â”‚Â Â      â”œâ”€â”€ 2781170484_5d61835d63.jpg
    â”‚Â Â      â”œâ”€â”€ 279113587_b4843db199.jpg
    â”‚Â Â      â”œâ”€â”€ 2792000093_e8ae0718cf.jpg
    â”‚Â Â      â”œâ”€â”€ 2801728106_833798c909.jpg
    â”‚Â Â      â”œâ”€â”€ 2822388965_f6dca2a275.jpg
    â”‚Â Â      â”œâ”€â”€ 2861002136_52c7c6f708.jpg
    â”‚Â Â      â”œâ”€â”€ 2908916142_a7ac8b57a8.jpg
    â”‚Â Â      â”œâ”€â”€ 29494643_e3410f0d37.jpg
    â”‚Â Â      â”œâ”€â”€ 2959730355_416a18c63c.jpg
    â”‚Â Â      â”œâ”€â”€ 2962405283_22718d9617.jpg
    â”‚Â Â      â”œâ”€â”€ 3006264892_30e9cced70.jpg
    â”‚Â Â      â”œâ”€â”€ 3030189811_01d095b793.jpg
    â”‚Â Â      â”œâ”€â”€ 3030772428_8578335616.jpg
    â”‚Â Â      â”œâ”€â”€ 3044402684_3853071a87.jpg
    â”‚Â Â      â”œâ”€â”€ 3074585407_9854eb3153.jpg
    â”‚Â Â      â”œâ”€â”€ 3079610310_ac2d0ae7bc.jpg
    â”‚Â Â      â”œâ”€â”€ 3090975720_71f12e6de4.jpg
    â”‚Â Â      â”œâ”€â”€ 3100226504_c0d4f1e3f1.jpg
    â”‚Â Â      â”œâ”€â”€ 342758693_c56b89b6b6.jpg
    â”‚Â Â      â”œâ”€â”€ 354167719_22dca13752.jpg
    â”‚Â Â      â”œâ”€â”€ 359928878_b3b418c728.jpg
    â”‚Â Â      â”œâ”€â”€ 365759866_b15700c59b.jpg
    â”‚Â Â      â”œâ”€â”€ 36900412_92b81831ad.jpg
    â”‚Â Â      â”œâ”€â”€ 39672681_1302d204d1.jpg
    â”‚Â Â      â”œâ”€â”€ 39747887_42df2855ee.jpg
    â”‚Â Â      â”œâ”€â”€ 421515404_e87569fd8b.jpg
    â”‚Â Â      â”œâ”€â”€ 444532809_9e931e2279.jpg
    â”‚Â Â      â”œâ”€â”€ 446296270_d9e8b93ecf.jpg
    â”‚Â Â      â”œâ”€â”€ 452462677_7be43af8ff.jpg
    â”‚Â Â      â”œâ”€â”€ 452462695_40a4e5b559.jpg
    â”‚Â Â      â”œâ”€â”€ 457457145_5f86eb7e9c.jpg
    â”‚Â Â      â”œâ”€â”€ 465133211_80e0c27f60.jpg
    â”‚Â Â      â”œâ”€â”€ 469333327_358ba8fe8a.jpg
    â”‚Â Â      â”œâ”€â”€ 472288710_2abee16fa0.jpg
    â”‚Â Â      â”œâ”€â”€ 473618094_8ffdcab215.jpg
    â”‚Â Â      â”œâ”€â”€ 476347960_52edd72b06.jpg
    â”‚Â Â      â”œâ”€â”€ 478701318_bbd5e557b8.jpg
    â”‚Â Â      â”œâ”€â”€ 507288830_f46e8d4cb2.jpg
    â”‚Â Â      â”œâ”€â”€ 509247772_2db2d01374.jpg
    â”‚Â Â      â”œâ”€â”€ 513545352_fd3e7c7c5d.jpg
    â”‚Â Â      â”œâ”€â”€ 522104315_5d3cb2758e.jpg
    â”‚Â Â      â”œâ”€â”€ 537309131_532bfa59ea.jpg
    â”‚Â Â      â”œâ”€â”€ 586041248_3032e277a9.jpg
    â”‚Â Â      â”œâ”€â”€ 760526046_547e8b381f.jpg
    â”‚Â Â      â”œâ”€â”€ 760568592_45a52c847f.jpg
    â”‚Â Â      â”œâ”€â”€ 774440991_63a4aa0cbe.jpg
    â”‚Â Â      â”œâ”€â”€ 85112639_6e860b0469.jpg
    â”‚Â Â      â”œâ”€â”€ 873076652_eb098dab2d.jpg
    â”‚Â Â      â”œâ”€â”€ 90179376_abc234e5f4.jpg
    â”‚Â Â      â”œâ”€â”€ 92663402_37f379e57a.jpg
    â”‚Â Â      â”œâ”€â”€ 95238259_98470c5b10.jpg
    â”‚Â Â      â”œâ”€â”€ 969455125_58c797ef17.jpg
    â”‚Â Â      â””â”€â”€ 98391118_bdb1e80cce.jpg
    â””â”€â”€ val
        â”œâ”€â”€ ants
        â”‚Â Â  â”œâ”€â”€ 10308379_1b6c72e180.jpg
        â”‚Â Â  â”œâ”€â”€ 1053149811_f62a3410d3.jpg
        â”‚Â Â  â”œâ”€â”€ 1073564163_225a64f170.jpg
        â”‚Â Â  â”œâ”€â”€ 1119630822_cd325ea21a.jpg
        â”‚Â Â  â”œâ”€â”€ 1124525276_816a07c17f.jpg
        â”‚Â Â  â”œâ”€â”€ 11381045_b352a47d8c.jpg
        â”‚Â Â  â”œâ”€â”€ 119785936_dd428e40c3.jpg
        â”‚Â Â  â”œâ”€â”€ 1247887232_edcb61246c.jpg
        â”‚Â Â  â”œâ”€â”€ 1262751255_c56c042b7b.jpg
        â”‚Â Â  â”œâ”€â”€ 1337725712_2eb53cd742.jpg
        â”‚Â Â  â”œâ”€â”€ 1358854066_5ad8015f7f.jpg
        â”‚Â Â  â”œâ”€â”€ 1440002809_b268d9a66a.jpg
        â”‚Â Â  â”œâ”€â”€ 147542264_79506478c2.jpg
        â”‚Â Â  â”œâ”€â”€ 152286280_411648ec27.jpg
        â”‚Â Â  â”œâ”€â”€ 153320619_2aeb5fa0ee.jpg
        â”‚Â Â  â”œâ”€â”€ 153783656_85f9c3ac70.jpg
        â”‚Â Â  â”œâ”€â”€ 157401988_d0564a9d02.jpg
        â”‚Â Â  â”œâ”€â”€ 159515240_d5981e20d1.jpg
        â”‚Â Â  â”œâ”€â”€ 161076144_124db762d6.jpg
        â”‚Â Â  â”œâ”€â”€ 161292361_c16e0bf57a.jpg
        â”‚Â Â  â”œâ”€â”€ 170652283_ecdaff5d1a.jpg
        â”‚Â Â  â”œâ”€â”€ 17081114_79b9a27724.jpg
        â”‚Â Â  â”œâ”€â”€ 172772109_d0a8e15fb0.jpg
        â”‚Â Â  â”œâ”€â”€ 1743840368_b5ccda82b7.jpg
        â”‚Â Â  â”œâ”€â”€ 181942028_961261ef48.jpg
        â”‚Â Â  â”œâ”€â”€ 183260961_64ab754c97.jpg
        â”‚Â Â  â”œâ”€â”€ 2039585088_c6f47c592e.jpg
        â”‚Â Â  â”œâ”€â”€ 205398178_c395c5e460.jpg
        â”‚Â Â  â”œâ”€â”€ 208072188_f293096296.jpg
        â”‚Â Â  â”œâ”€â”€ 209615353_eeb38ba204.jpg
        â”‚Â Â  â”œâ”€â”€ 2104709400_8831b4fc6f.jpg
        â”‚Â Â  â”œâ”€â”€ 212100470_b485e7b7b9.jpg
        â”‚Â Â  â”œâ”€â”€ 2127908701_d49dc83c97.jpg
        â”‚Â Â  â”œâ”€â”€ 2191997003_379df31291.jpg
        â”‚Â Â  â”œâ”€â”€ 2211974567_ee4606b493.jpg
        â”‚Â Â  â”œâ”€â”€ 2219621907_47bc7cc6b0.jpg
        â”‚Â Â  â”œâ”€â”€ 2238242353_52c82441df.jpg
        â”‚Â Â  â”œâ”€â”€ 2255445811_dabcdf7258.jpg
        â”‚Â Â  â”œâ”€â”€ 239161491_86ac23b0a3.jpg
        â”‚Â Â  â”œâ”€â”€ 263615709_cfb28f6b8e.jpg
        â”‚Â Â  â”œâ”€â”€ 308196310_1db5ffa01b.jpg
        â”‚Â Â  â”œâ”€â”€ 319494379_648fb5a1c6.jpg
        â”‚Â Â  â”œâ”€â”€ 35558229_1fa4608a7a.jpg
        â”‚Â Â  â”œâ”€â”€ 412436937_4c2378efc2.jpg
        â”‚Â Â  â”œâ”€â”€ 436944325_d4925a38c7.jpg
        â”‚Â Â  â”œâ”€â”€ 445356866_6cb3289067.jpg
        â”‚Â Â  â”œâ”€â”€ 459442412_412fecf3fe.jpg
        â”‚Â Â  â”œâ”€â”€ 470127071_8b8ee2bd74.jpg
        â”‚Â Â  â”œâ”€â”€ 477437164_bc3e6e594a.jpg
        â”‚Â Â  â”œâ”€â”€ 488272201_c5aa281348.jpg
        â”‚Â Â  â”œâ”€â”€ 502717153_3e4865621a.jpg
        â”‚Â Â  â”œâ”€â”€ 518746016_bcc28f8b5b.jpg
        â”‚Â Â  â”œâ”€â”€ 540543309_ddbb193ee5.jpg
        â”‚Â Â  â”œâ”€â”€ 562589509_7e55469b97.jpg
        â”‚Â Â  â”œâ”€â”€ 57264437_a19006872f.jpg
        â”‚Â Â  â”œâ”€â”€ 573151833_ebbc274b77.jpg
        â”‚Â Â  â”œâ”€â”€ 649407494_9b6bc4949f.jpg
        â”‚Â Â  â”œâ”€â”€ 751649788_78dd7d16ce.jpg
        â”‚Â Â  â”œâ”€â”€ 768870506_8f115d3d37.jpg
        â”‚Â Â  â”œâ”€â”€ 800px-Meat_eater_ant_qeen_excavating_hole.jpg
        â”‚Â Â  â”œâ”€â”€ 8124241_36b290d372.jpg
        â”‚Â Â  â”œâ”€â”€ 8398478_50ef10c47a.jpg
        â”‚Â Â  â”œâ”€â”€ 854534770_31f6156383.jpg
        â”‚Â Â  â”œâ”€â”€ 892676922_4ab37dce07.jpg
        â”‚Â Â  â”œâ”€â”€ 94999827_36895faade.jpg
        â”‚Â Â  â”œâ”€â”€ Ant-1818.jpg
        â”‚Â Â  â”œâ”€â”€ ants-devouring-remains-of-large-dead-insect-on-red-tile-in-Stellenbosch-South-Africa-closeup-1-DHD.jpg
        â”‚Â Â  â”œâ”€â”€ desert_ant.jpg
        â”‚Â Â  â”œâ”€â”€ F.pergan.28(f).jpg
        â”‚Â Â  â””â”€â”€ Hormiga.jpg
        â””â”€â”€ bees
            â”œâ”€â”€ 1032546534_06907fe3b3.jpg
            â”œâ”€â”€ 10870992_eebeeb3a12.jpg
            â”œâ”€â”€ 1181173278_23c36fac71.jpg
            â”œâ”€â”€ 1297972485_33266a18d9.jpg
            â”œâ”€â”€ 1328423762_f7a88a8451.jpg
            â”œâ”€â”€ 1355974687_1341c1face.jpg
            â”œâ”€â”€ 144098310_a4176fd54d.jpg
            â”œâ”€â”€ 1486120850_490388f84b.jpg
            â”œâ”€â”€ 149973093_da3c446268.jpg
            â”œâ”€â”€ 151594775_ee7dc17b60.jpg
            â”œâ”€â”€ 151603988_2c6f7d14c7.jpg
            â”œâ”€â”€ 1519368889_4270261ee3.jpg
            â”œâ”€â”€ 152789693_220b003452.jpg
            â”œâ”€â”€ 177677657_a38c97e572.jpg
            â”œâ”€â”€ 1799729694_0c40101071.jpg
            â”œâ”€â”€ 181171681_c5a1a82ded.jpg
            â”œâ”€â”€ 187130242_4593a4c610.jpg
            â”œâ”€â”€ 203868383_0fcbb48278.jpg
            â”œâ”€â”€ 2060668999_e11edb10d0.jpg
            â”œâ”€â”€ 2086294791_6f3789d8a6.jpg
            â”œâ”€â”€ 2103637821_8d26ee6b90.jpg
            â”œâ”€â”€ 2104135106_a65eede1de.jpg
            â”œâ”€â”€ 215512424_687e1e0821.jpg
            â”œâ”€â”€ 2173503984_9c6aaaa7e2.jpg
            â”œâ”€â”€ 220376539_20567395d8.jpg
            â”œâ”€â”€ 224841383_d050f5f510.jpg
            â”œâ”€â”€ 2321144482_f3785ba7b2.jpg
            â”œâ”€â”€ 238161922_55fa9a76ae.jpg
            â”œâ”€â”€ 2407809945_fb525ef54d.jpg
            â”œâ”€â”€ 2415414155_1916f03b42.jpg
            â”œâ”€â”€ 2438480600_40a1249879.jpg
            â”œâ”€â”€ 2444778727_4b781ac424.jpg
            â”œâ”€â”€ 2457841282_7867f16639.jpg
            â”œâ”€â”€ 2470492902_3572c90f75.jpg
            â”œâ”€â”€ 2478216347_535c8fe6d7.jpg
            â”œâ”€â”€ 2501530886_e20952b97d.jpg
            â”œâ”€â”€ 2506114833_90a41c5267.jpg
            â”œâ”€â”€ 2509402554_31821cb0b6.jpg
            â”œâ”€â”€ 2525379273_dcb26a516d.jpg
            â”œâ”€â”€ 26589803_5ba7000313.jpg
            â”œâ”€â”€ 2668391343_45e272cd07.jpg
            â”œâ”€â”€ 2670536155_c170f49cd0.jpg
            â”œâ”€â”€ 2685605303_9eed79d59d.jpg
            â”œâ”€â”€ 2702408468_d9ed795f4f.jpg
            â”œâ”€â”€ 2709775832_85b4b50a57.jpg
            â”œâ”€â”€ 2717418782_bd83307d9f.jpg
            â”œâ”€â”€ 272986700_d4d4bf8c4b.jpg
            â”œâ”€â”€ 2741763055_9a7bb00802.jpg
            â”œâ”€â”€ 2745389517_250a397f31.jpg
            â”œâ”€â”€ 2751836205_6f7b5eff30.jpg
            â”œâ”€â”€ 2782079948_8d4e94a826.jpg
            â”œâ”€â”€ 2809496124_5f25b5946a.jpg
            â”œâ”€â”€ 2815838190_0a9889d995.jpg
            â”œâ”€â”€ 2841437312_789699c740.jpg
            â”œâ”€â”€ 2883093452_7e3a1eb53f.jpg
            â”œâ”€â”€ 290082189_f66cb80bfc.jpg
            â”œâ”€â”€ 296565463_d07a7bed96.jpg
            â”œâ”€â”€ 3077452620_548c79fda0.jpg
            â”œâ”€â”€ 348291597_ee836fbb1a.jpg
            â”œâ”€â”€ 350436573_41f4ecb6c8.jpg
            â”œâ”€â”€ 353266603_d3eac7e9a0.jpg
            â”œâ”€â”€ 372228424_16da1f8884.jpg
            â”œâ”€â”€ 400262091_701c00031c.jpg
            â”œâ”€â”€ 416144384_961c326481.jpg
            â”œâ”€â”€ 44105569_16720a960c.jpg
            â”œâ”€â”€ 456097971_860949c4fc.jpg
            â”œâ”€â”€ 464594019_1b24a28bb1.jpg
            â”œâ”€â”€ 485743562_d8cc6b8f73.jpg
            â”œâ”€â”€ 540976476_844950623f.jpg
            â”œâ”€â”€ 54736755_c057723f64.jpg
            â”œâ”€â”€ 57459255_752774f1b2.jpg
            â”œâ”€â”€ 576452297_897023f002.jpg
            â”œâ”€â”€ 586474709_ae436da045.jpg
            â”œâ”€â”€ 590318879_68cf112861.jpg
            â”œâ”€â”€ 59798110_2b6a3c8031.jpg
            â”œâ”€â”€ 603709866_a97c7cfc72.jpg
            â”œâ”€â”€ 603711658_4c8cd2201e.jpg
            â”œâ”€â”€ 65038344_52a45d090d.jpg
            â”œâ”€â”€ 6a00d8341c630a53ef00e553d0beb18834-800wi.jpg
            â”œâ”€â”€ 72100438_73de9f17af.jpg
            â”œâ”€â”€ 759745145_e8bc776ec8.jpg
            â”œâ”€â”€ 936182217_c4caa5222d.jpg
            â””â”€â”€ abeja.jpg
    
    6 directories, 398 files
    

### Transforms ì •ì˜


```python
# Transforms ì •ì˜

# ê²€ì¦ ë°ì´í„° : ì •ê·œí™”
test_transform = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(0.5, 0.5)
])

# í›ˆë ¨ ë°ì´í„° : ì •ê·œí™”ì— ë°˜ì „ê³¼ RandomErasing ì¶”ê°€
train_transform = transforms.Compose([
    transforms.RandomResizedCrop(224),
    transforms.RandomHorizontalFlip(),
    transforms.ToTensor(),
    transforms.Normalize(0.5, 0.5),
    transforms.RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3), value=0, inplace=False)
])
```

### ë°ì´í„°ì…‹ ì •ì˜


```python
# ë² ì´ìŠ¤ ë””ë ‰í„°ë¦¬
data_dir = 'hymenoptera_data'

# í›ˆë ¨ ë°ì´í„° ë””ë ‰í„°ë¦¬ì™€ ê²€ì¦ ë°ì´í„° ë””ë ‰í„°ë¦¬ ì§€ì •
import os
train_dir = os.path.join(data_dir, 'train')
test_dir = os.path.join(data_dir, 'val')

# join í•¨ìˆ˜ ê²°ê³¼ í™•ì¸
print(train_dir, test_dir)

# ë¶„ë¥˜í•˜ë ¤ëŠ” í´ë˜ìŠ¤ì˜ ë¦¬ìŠ¤íŠ¸ ì‘ì„±
classes = ['ants', 'bees']
```

    hymenoptera_data/train hymenoptera_data/val
    


```python
# ë°ì´í„°ì…‹ ì •ì˜

# í›ˆë ¨ìš©
train_data = datasets.ImageFolder(train_dir, 
            transform=train_transform)
# í›ˆë ¨ ë°ì´í„° ì´ë¯¸ì§€ ì¶œë ¥ìš©
train_data2 = datasets.ImageFolder(train_dir, 
            transform=test_transform)
# ê²€ì¦ìš©
test_data = datasets.ImageFolder(test_dir, 
            transform=test_transform)
```


```python
# ë°ì´í„° ê±´ìˆ˜ í™•ì¸

print(f'í›ˆë ¨ ë°ì´í„° : {len(train_data)} ê±´')
print(f'ê²€ì¦ ë°ì´í„° : {len(test_data)} ê±´')
```

    í›ˆë ¨ ë°ì´í„° : 244 ê±´
    ê²€ì¦ ë°ì´í„° : 153 ê±´
    


```python
# ê²€ì¦ ë°ì´í„°ã€€
# ì²˜ìŒ 10ê°œì™€ ë§ˆì§€ë§‰ 10ê°œ ì´ë¯¸ì§€ ì¶œë ¥

plt.figure(figsize=(15, 4))
for i in range(10):
    ax = plt.subplot(2, 10, i + 1)
    image, label = test_data[i]
    img = (np.transpose(image.numpy(), (1, 2, 0)) + 1)/2
    plt.imshow(img)
    ax.set_title(classes[label])
    ax.get_xaxis().set_visible(False)
    ax.get_yaxis().set_visible(False)

    ax = plt.subplot(2, 10, i + 11)
    image, label = test_data[-i-1]
    img = (np.transpose(image.numpy(), (1, 2, 0)) + 1)/2
    plt.imshow(img)
    ax.set_title(classes[label])
    ax.get_xaxis().set_visible(False)
    ax.get_yaxis().set_visible(False)

plt.show()
```


    
![png](output_22_0.png)
    


### ë°ì´í„°ë¡œë” ì •ì˜


```python
# ë°ì´í„°ë¡œë” ì •ì˜

batch_size = 10

# í›ˆë ¨ìš©
train_loader = DataLoader(train_data, 
      batch_size=batch_size, shuffle=True)

# ê²€ì¦ìš©
test_loader = DataLoader(test_data, 
      batch_size=batch_size, shuffle=False)

# ì´ë¯¸ì§€ ì¶œë ¥ìš©
train_loader2 = DataLoader(train_data2, 
      batch_size=50, shuffle=True)
test_loader2 = DataLoader(test_data, 
      batch_size=50, shuffle=True)
```

### ì´ë¯¸ì§€ ì¶œë ¥


```python
# ê²€ì¦ ë°ì´í„°(50ê±´)
torch_seed()
show_images_labels(test_loader2, classes, None, None)
```


    
![png](output_26_0.png)
    


## 12.4 íŒŒì¸ íŠœë‹ì˜ ê²½ìš°


```python
# íŒŒì¸ íŠœë‹ì˜ ê²½ìš°

# ì‚¬ì „ í•™ìŠµ ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°
# VGG-19-BN ëª¨ë¸ì„ í•™ìŠµì´ ëë‚œ íŒŒë¼ë¯¸í„°ì™€ í•¨ê»˜ ë¶ˆëŸ¬ì˜¤ê¸°
from torchvision import models
net = models.vgg19_bn(pretrained = True)

# ë‚œìˆ˜ ê³ ì •
torch_seed()

# ìµœì¢… ë…¸ë“œì˜ ì¶œë ¥ì„ 2ë¡œ ë³€ê²½
in_features = net.classifier[6].in_features
net.classifier[6] = nn.Linear(in_features, 2)

# AdaptiveAvgPool2d í•¨ìˆ˜ ì œê±°
net.avgpool = nn.Identity()

# GPU ì‚¬ìš©
net = net.to(device)

# í•™ìŠµë¥ 
lr = 0.001

# ì†ì‹¤ í•¨ìˆ˜ ì •ì˜
criterion = nn.CrossEntropyLoss()

# ìµœì í™” í•¨ìˆ˜ ì •ì˜
optimizer = optim.SGD(net.parameters(),lr=lr,momentum=0.9)

# history íŒŒì¼ë„ ë™ì‹œì— ì´ˆê¸°í™”
history = np.zeros((0, 5))
```


```python
# í•™ìŠµ
num_epochs = 5
history = fit(net, optimizer, criterion, num_epochs, 
          train_loader, test_loader, device, history)
```


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [1/5], loss: 0.04421 acc: 0.78689 val_loss: 0.01105, val_acc: 0.96078
    


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [2/5], loss: 0.01980 acc: 0.92213 val_loss: 0.01319, val_acc: 0.96732
    


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [3/5], loss: 0.02082 acc: 0.91803 val_loss: 0.01025, val_acc: 0.97386
    


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [4/5], loss: 0.01423 acc: 0.93443 val_loss: 0.01558, val_acc: 0.96078
    


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [5/5], loss: 0.01413 acc: 0.93443 val_loss: 0.01236, val_acc: 0.95425
    


```python
# ê²°ê³¼ í™•ì¸
evaluate_history(history)
```

    ì´ˆê¸°ìƒíƒœ : ì†ì‹¤ : 0.01105  ì •í™•ë„ : 0.96078
    ìµœì¢…ìƒíƒœ : ì†ì‹¤ : 0.01236 ì •í™•ë„ : 0.95425
    


    
![png](output_30_1.png)
    



    
![png](output_30_2.png)
    



```python
# ë‚œìˆ˜ ê³ ì •
torch_seed()

# ê²€ì¦ ë°ì´í„° ê²°ê³¼ ì¶œë ¥
show_images_labels(test_loader2, classes, net, device)
```


    
![png](output_31_0.png)
    



## 12.5 ì „ì´ í•™ìŠµì˜ ê²½ìš°


```python
# VGG-19-BN ëª¨ë¸ì„ í•™ìŠµì´ ëë‚œ íŒŒë¼ë¯¸í„°ì™€ í•¨ê»˜ ë¶ˆëŸ¬ì˜¤ê¸°
from torchvision import models
net = models.vgg19_bn(pretrained = True)

# ëª¨ë“  íŒŒë¼ë¯¸í„°ì˜ ê²½ì‚¬ ê³„ì‚°ì„ OFFë¡œ ì„¤ì •
for param in net.parameters():
    param.requires_grad = False

# ë‚œìˆ˜ ê³ ì •
torch_seed()

# ìµœì¢… ë…¸ë“œì˜ ì¶œë ¥ì„ 2ë¡œ ë³€ê²½
# ì´ ë…¸ë“œì— ëŒ€í•´ì„œë§Œ ê²½ì‚¬ ê³„ì‚°ì„ ìˆ˜í–‰í•˜ê²Œ ë¨
in_features = net.classifier[6].in_features
net.classifier[6] = nn.Linear(in_features, 2)

# AdaptiveAvgPool2d í•¨ìˆ˜ ì œê±°
net.avgpool = nn.Identity()

# GPU ì‚¬ìš©
net = net.to(device)

# í•™ìŠµë¥ 
lr = 0.001

# ì†ì‹¤ í•¨ìˆ˜ë¡œ êµì°¨ ì—”íŠ¸ë¡œí”¼ ì‚¬ìš©
criterion = nn.CrossEntropyLoss()

# ìµœì í™” í•¨ìˆ˜ ì •ì˜
# íŒŒë¼ë¯¸í„° ìˆ˜ì • ëŒ€ìƒì„ ìµœì¢… ë…¸ë“œë¡œ ì œí•œ
optimizer = optim.SGD(net.classifier[6].parameters(),lr=lr,momentum=0.9)

# history íŒŒì¼ë„ ë™ì‹œì— ì´ˆê¸°í™”
history = np.zeros((0, 5))
```


```python
# í•™ìŠµ
num_epochs = 5
history = fit(net, optimizer, criterion, num_epochs, 
          train_loader, test_loader, device, history)
```


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [1/5], loss: 0.04625 acc: 0.78279 val_loss: 0.01375, val_acc: 0.96078
    


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [2/5], loss: 0.02263 acc: 0.92213 val_loss: 0.01272, val_acc: 0.96078
    


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [3/5], loss: 0.02457 acc: 0.90164 val_loss: 0.01185, val_acc: 0.95425
    


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [4/5], loss: 0.02028 acc: 0.90164 val_loss: 0.01275, val_acc: 0.95425
    


      0%|          | 0/25 [00:00<?, ?it/s]


    Epoch [5/5], loss: 0.02133 acc: 0.88934 val_loss: 0.01191, val_acc: 0.96078
    


```python
# ê²°ê³¼ í™•ì¸
evaluate_history(history)
```

    ì´ˆê¸°ìƒíƒœ : ì†ì‹¤ : 0.01375  ì •í™•ë„ : 0.96078
    ìµœì¢…ìƒíƒœ : ì†ì‹¤ : 0.01191 ì •í™•ë„ : 0.96078
    


    
![png](output_35_1.png)
    



    
![png](output_35_2.png)
    



```python
# ë‚œìˆ˜ ê³ ì •
torch_seed()

# ê²€ì¦ ë°ì´í„° ê²°ê³¼ ì¶œë ¥
show_images_labels(test_loader2, classes, net, device)
```


    
![png](output_36_0.png)
    


## 12.6 ì‚¬ìš©ì ì •ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
ì‹œë² ë¦¬ì•ˆ í—ˆìŠ¤í‚¤ì™€ ëŠ‘ëŒ€ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•¨

### ë°ì´í„° ë‹¤ìš´ë¡œë“œ, ì••ì¶• í•´ì œ


```python
# ë°ì´í„° ë‹¤ìš´ë¡œë“œ
w = !wget https://github.com/makaishi2/pythonlibs/raw/main/images/dog_wolf.zip
print(w[-2])

# ì••ì¶• í•´ì œ
!unzip dog_wolf.zip | tail -n 1

# íŠ¸ë¦¬ êµ¬ì¡° í™•ì¸
!tree dog_wolf
```

    2022-04-10 14:43:13 (142 MB/s) - â€˜dog_wolf.zipâ€™ saved [21811374/21811374]
      inflating: dog_wolf/train/wolf/wolf-09.png  
    dog_wolf
    â”œâ”€â”€ test
    â”‚Â Â  â”œâ”€â”€ dog
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dog-21.png
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dog-22.png
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dog-23.png
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dog-24.png
    â”‚Â Â  â”‚Â Â  â””â”€â”€ dog-25.png
    â”‚Â Â  â””â”€â”€ wolf
    â”‚Â Â      â”œâ”€â”€ wolf-21.png
    â”‚Â Â      â”œâ”€â”€ wolf-22.png
    â”‚Â Â      â”œâ”€â”€ wolf-23.png
    â”‚Â Â      â”œâ”€â”€ wolf-24.png
    â”‚Â Â      â””â”€â”€ wolf-25.png
    â””â”€â”€ train
        â”œâ”€â”€ dog
        â”‚Â Â  â”œâ”€â”€ dog-01.png
        â”‚Â Â  â”œâ”€â”€ dog-02.png
        â”‚Â Â  â”œâ”€â”€ dog-03.png
        â”‚Â Â  â”œâ”€â”€ dog-04.png
        â”‚Â Â  â”œâ”€â”€ dog-05.png
        â”‚Â Â  â”œâ”€â”€ dog-06.png
        â”‚Â Â  â”œâ”€â”€ dog-07.png
        â”‚Â Â  â”œâ”€â”€ dog-08.png
        â”‚Â Â  â”œâ”€â”€ dog-09.png
        â”‚Â Â  â”œâ”€â”€ dog-10.png
        â”‚Â Â  â”œâ”€â”€ dog-11.png
        â”‚Â Â  â”œâ”€â”€ dog-12.png
        â”‚Â Â  â”œâ”€â”€ dog-13.png
        â”‚Â Â  â”œâ”€â”€ dog-14.png
        â”‚Â Â  â”œâ”€â”€ dog-15.png
        â”‚Â Â  â”œâ”€â”€ dog-16.png
        â”‚Â Â  â”œâ”€â”€ dog-17.png
        â”‚Â Â  â”œâ”€â”€ dog-18.png
        â”‚Â Â  â”œâ”€â”€ dog-19.png
        â”‚Â Â  â””â”€â”€ dog-20.png
        â””â”€â”€ wolf
            â”œâ”€â”€ wolf-01.png
            â”œâ”€â”€ wolf-02.png
            â”œâ”€â”€ wolf-03.png
            â”œâ”€â”€ wolf-04.png
            â”œâ”€â”€ wolf-05.png
            â”œâ”€â”€ wolf-06.png
            â”œâ”€â”€ wolf-07.png
            â”œâ”€â”€ wolf-08.png
            â”œâ”€â”€ wolf-09.png
            â”œâ”€â”€ wolf-10.png
            â”œâ”€â”€ wolf-11.png
            â”œâ”€â”€ wolf-12.png
            â”œâ”€â”€ wolf-13.png
            â”œâ”€â”€ wolf-14.png
            â”œâ”€â”€ wolf-15.png
            â”œâ”€â”€ wolf-16.png
            â”œâ”€â”€ wolf-17.png
            â”œâ”€â”€ wolf-18.png
            â”œâ”€â”€ wolf-19.png
            â””â”€â”€ wolf-20.png
    
    6 directories, 50 files
    

### Transforms ì •ì˜


```python
# Transforms ì •ì˜

# ê²€ì¦ ë°ì´í„° : ì •ê·œí™”
test_transform = transforms.Compose([
    transforms.Resize(224),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(0.5, 0.5)
])

# í›ˆë ¨ ë°ì´í„° : ì •ê·œí™”ì— ë°˜ì „ê³¼ RandomErasing ì¶”ê°€
train_transform = transforms.Compose([
    transforms.RandomHorizontalFlip(p=0.5), 
    transforms.Resize(224),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(0.5, 0.5),
    transforms.RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3), value=0, inplace=False)   
])
```

### ë°ì´í„°ì…‹ ì •ì˜


```python
# ë°ì´í„°ì…‹ ì •ì˜

data_dir = 'dog_wolf'

import os
train_dir = os.path.join(data_dir, 'train')
test_dir = os.path.join(data_dir, 'test')

classes = ['dog', 'wolf']

train_data = datasets.ImageFolder(train_dir, 
            transform=train_transform)
train_data2 = datasets.ImageFolder(train_dir, 
            transform=test_transform)
test_data = datasets.ImageFolder(test_dir, 
            transform=test_transform)
```


```python
# ë°ì´í„° ê±´ìˆ˜ í™•ì¸

print(f'í•™ìŠµ ë°ì´í„° : {len(train_data)} ê±´')
print(f'ê²€ì¦ ë°ì´í„° : {len(test_data)} ê±´')
```

    í•™ìŠµ ë°ì´í„° : 40 ê±´
    ê²€ì¦ ë°ì´í„° : 10 ê±´
    

### ë°ì´í„°ë¡œë” ì •ì˜


```python
# ë°ì´í„°ë¡œë” ì •ì˜

batch_size = 5
# í›ˆë ¨ ë°ì´í„°
train_loader = DataLoader(train_data, 
            batch_size=batch_size, shuffle=True)
# í›ˆë ¨ ë°ì´í„°, ì´ë¯¸ì§€ ì¶œë ¥ìš©
train_loader2 = DataLoader(train_data2, 
            batch_size=40, shuffle=False)
# ê²€ì¦ ë°ì´í„°
test_loader = DataLoader(test_data, 
            batch_size=batch_size, shuffle=False)
# ê²€ì¦ë°ì´í„°, ì´ë¯¸ì§€ ì¶œë ¥ìš©
test_loader2 = DataLoader(test_data, 
            batch_size=10, shuffle=True)
```

### ì´ë¯¸ì§€ ì¶œë ¥


```python
# í›ˆë ¨ ë°ì´í„°(40ê±´)
show_images_labels(train_loader2, classes, None, None)
```


    
![png](output_48_0.png)
    



```python
# ê²€ì¦ ë°ì´í„°(10ê±´)
torch_seed()
show_images_labels(test_loader2, classes, None, None)
```


    
![png](output_49_0.png)
    


### ëª¨ë¸ ì •ì˜


```python
# ì‚¬ì „ í•™ìŠµ ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°
net = models.vgg19_bn(pretrained = True)

for param in net.parameters():
    param.requires_grad = False

# ë‚œìˆ˜ ê³ ì •
torch_seed()

# ë§ˆì§€ë§‰ ë…¸ë“œ ì¶œë ¥ì„ 2ë¡œ ë³€ê²½
in_features = net.classifier[6].in_features
net.classifier[6] = nn.Linear(in_features, 2)

# AdaptiveAvgPool2d í•¨ìˆ˜ ì œê±°
net.avgpool = nn.Identity()

# GPU ì‚¬ìš©
net = net.to(device)

# í•™ìŠµë¥ 
lr = 0.001

# ì†ì‹¤ í•¨ìˆ˜ ì •ì˜
criterion = nn.CrossEntropyLoss()

# ìµœì í™” í•¨ìˆ˜ ì •ì˜
# íŒŒë¼ë¯¸í„° ìˆ˜ì • ëŒ€ìƒì„ ìµœì¢… ë…¸ë“œë¡œ ì œí•œ
optimizer = optim.SGD(net.classifier[6].parameters(),lr=lr,momentum=0.9)

# history íŒŒì¼ë„ ë™ì‹œì— ì´ˆê¸°í™”
history = np.zeros((0, 5))
```


```python
# í•™ìŠµ
num_epochs = 10
history = fit(net, optimizer, criterion, num_epochs, 
          train_loader, test_loader, device, history)
```


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [1/10], loss: 0.12345 acc: 0.65000 val_loss: 0.07783, val_acc: 1.00000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [2/10], loss: 0.07584 acc: 0.85000 val_loss: 0.04895, val_acc: 0.90000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [3/10], loss: 0.03976 acc: 0.92500 val_loss: 0.05762, val_acc: 0.80000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [4/10], loss: 0.04213 acc: 0.92500 val_loss: 0.03992, val_acc: 1.00000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [5/10], loss: 0.01836 acc: 0.97500 val_loss: 0.02970, val_acc: 1.00000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [6/10], loss: 0.02144 acc: 0.97500 val_loss: 0.04182, val_acc: 0.90000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [7/10], loss: 0.03019 acc: 0.95000 val_loss: 0.03631, val_acc: 0.90000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [8/10], loss: 0.04319 acc: 0.92500 val_loss: 0.03186, val_acc: 1.00000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [9/10], loss: 0.01086 acc: 1.00000 val_loss: 0.02766, val_acc: 1.00000
    


      0%|          | 0/8 [00:00<?, ?it/s]


    Epoch [10/10], loss: 0.04419 acc: 0.92500 val_loss: 0.03189, val_acc: 1.00000
    


```python
# ê²°ê³¼ í™•ì¸
evaluate_history(history)
```

    ì´ˆê¸°ìƒíƒœ : ì†ì‹¤ : 0.07783  ì •í™•ë„ : 1.00000
    ìµœì¢…ìƒíƒœ : ì†ì‹¤ : 0.03189 ì •í™•ë„ : 1.00000
    


    
![png](output_53_1.png)
    



    
![png](output_53_2.png)
    



```python
# ì˜ˆì¸¡ ê²°ê³¼ ì¶œë ¥
torch_seed()
show_images_labels(test_loader2, classes, net, device)
```


    
![png](output_54_0.png)
    

